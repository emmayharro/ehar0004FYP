%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                         Final Year Project                              %
%                               2020                                      %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Written by: Emily Harrison (ID: 28761537)
% Supervised by: Dr Bill Corcoran

% PROJECT AIM: simulate an optical communications system that uses Optical
% Injection Locking to improve the reliability of the system

% THE PROJECT focuses on M-QAM signals, where M is between 4 and 64. It
% uses linewidths ranging from 1kHz to 100MHz.

% THIS SCRIPT contains the arrays of results used to produce the plots in
% the poster, report and video. 

% NAMING of arrays determines which metric is being shown, which QAM levls
% and which recovery technique was used.

%% Housekeeping
close all; clear all; clc;

linewidth = [1e3, 1e4, 1e5, 2e5, 5e5, 1e6, 2e6, 5e6, 1e7, 2e7, 5e7, 1e8];

%% Recovery technique = 0
%with DC_fact = 0.02
BER4_PC = [0, 0, 0, 0, 0, 0, 0, 0, 4.6964e-05, 0.0011976, 0.038592, 0.086989];
Q4_PC = [20.7375, 20.7394, 20.616, 20.5289, 20.0745, 19.1627, 18.2379, ...
    15.8426, 13.8107, 11.3783, 7.1802, 5.0557];

BER16_PC = [0, 0, 0, 1.1741e-05, 1.7611e-05, 0.00012328, 0.00089231, ...
    0.0058529, 0.021462, 0.04859, 0.11288, 0.17105];
Q16_PC = [19.9258, 19.9083, 19.7671, 19.6348, 19.2627, 18.7182, 17.6002, ...
    15.6676, 13.4411, 10.9782, 7.1675, 4.4302];

BER64_PC = [0.010586, 0.011209, 0.011522, 0.012794, 0.01542, 0.019952, ...
    0.029591, 0.053817, 0.0785, 0.12851, 0.21946, 0.23976];
Q64_PC = [19.6867, 19.5874, 19.5256, 19.3953, 19.0637, 18.4967, 17.5301, ...
    15.3756, 13.5606, 10.3556, 5.7806, 4.8452];
GMIx64_PC = [5.6537, 5.6559, 5.6484, 5.6107, 5.5003, 5.4286, 5.2319, 4.7, ...
    4.042, 3.3921, 1.88, 1.6274];
GMIy64_PC = [5.6348, 5.6549, 5.6102, 5.617, 5.4935, 5.4042, 5.2035, 4.6881, ...
    4.0336, 3.3758, 1.8868, 1.6161];

%% Recovery technique = 1
% wc = gap/35
BER4_BWs = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00032875, 0.0087118, 0.039309];
Q4_BWs = [17.3947, 17.3966, 17.3589, 17.3203, 17.1656, 16.983, 16.5573, ...
    15.5697, 14.2424, 12.4819, 9.5523, 7.0354];

BER16_BWs = [0.0016613, 0.0016848, 0.001679, 0.0017494, 0.0020018, 0.0027767, ...
    0.0038041, 0.0074672, 0.015522, 0.031542, 0.072436, 0.11943];
Q16_BWs = [16.7553, 16.786, 16.7312, 16.6707, 16.606, 16.3647, 16.0302, ...
    15.1605, 13.9562, 12.3289, 9.3419, 6.7833];

BER64_BWs = [0.038835, 0.039074, 0.040737, 0.040037, 0.0415, 0.043817, ...
    0.04786, 0.05917, 0.073741, 0.10024, 0.14711, 0.1992];
Q64_BWs = [16.7368, 16.7079, 16.6049, 16.6242, 16.529, 16.3159, 15.9762, ...
    15.1068, 14.0118, 12.1652, 9.3762, 6.8434];
GMIx64_BWs = [5.1136, 5.1122, 5.0914, 5.1013, 5.0678, 5.0077, 4.905, 4.6559, ...
    4.3337, 3.7916, 2.9709, 2.2009];
GMIy64_BWs = [5.09, 5.0747, 5.0518, 5.0461, 5.0227, 4.9751, 4.8858, 4.6425, ...
    4.3155, 3.7744, 2.9469, 2.1898];

%% Recovery technique = 2
BER4_BW = [0, 0, 0, 0, 0, 0, 0, 0, 1.1741e-05, 0.0001996, 0.0096511, 0.04242];
Q4_BW = [19.675, 19.7083, 19.6148, 19.5867, 19.4335, 19.1662, 18.1702, ...
    16.7462, 14.8333, 12.9213, 9.4046, 6.9552];

BER16_BW = [3.5223e-05, 5.2834e-05, 9.3928e-05, 8.2187e-05, 9.9798e-05,...
    0.0001585, 0.00090992, 0.0033697, 0.01153, 0.027151, 0.071232, 0.11434];
Q16_BW = [18.9253, 18.8628, 18.7845, 18.8118, 18.637, 18.4512, 17.5855, ...
    16.4144, 14.7369, 12.8175, 9.4871, 7.0038];

BER64_BW = [0.021513, 0.021396, 0.021881, 0.022398, 0.023141, 0.025177, ...
    0.03361, 0.046702, 0.06598, 0.094479, 0.1472, 0.19933];
Q64_BW = [18.3291, 18.3388, 18.2865, 18.2331, 18.1555, 17.9454, 17.2002, ...
    16.0683, 14.5517, 12.4409, 9.4131, 6.6386];
GMIx64_BW = [5.5389, 5.5438, 5.5474, 5.5266, 5.5209, 5.4697, 5.3136, 5.0075, ...
    4.6205, 4.0064, 3.0324, 2.2528];
GMIy64_BW = [5.5487, 5.5501, 5.5365, 5.5428, 5.5158, 5.4615, 5.3028, 4.9935, ...
    4.6353, 4.0046, 3.0335, 2.245];


%% Recovery technique = 3
% tone_fact=0.2, DC_fact = 0.02, zero below -9dB(12.6%)
BER4_L9 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2.3482e-05, 0.00093928];
Q4_L9 = [18.5914, 18.5909, 18.5239, 18.5395, 18.4776, 18.4084, 18.2208, ...
    17.7501, 17.0869, 16.0105, 13.8521, 11.8598];

BER16_L9 = [0.00041093, 0.00052247, 0.00046964, 0.00043442, 0.00046377, ...
    0.00055182, 0.00069859, 0.0013091, 0.0022249, 0.0056826, 0.019073, 0.039661];
Q16_L9 = [17.9237, 17.9074, 17.8933, 17.883, 17.8374, 17.7612, 17.5491, ...
    17.1448, 16.6088, 15.6603, 13.555, 11.5727];

BER64_L9 = [0.02866, 0.028617, 0.028859, 0.02902, 0.029963, 0.030409, ...
    0.031888, 0.036291, 0.04341, 0.055848, 0.082281, 0.11769];
Q64_L9 = [17.6465, 17.6435, 17.6132, 17.5846, 17.5292, 17.4891, 17.3435, ...
    16.9411, 16.3424, 15.4068, 13.4395, 11.2837];
GMIx64_L9 = [5.3297, 5.3447, 5.3506, 5.325, 5.3273, 5.3002, 5.2772, 5.1615, ...
    5.0227, 4.736, 4.1754, 3.5455];
GMIy64_L9 = [5.3912, 5.39, 5.3943, 5.3993, 5.375, 5.3613, 5.3173, 5.2065, ...
    5.0597, 4.7631, 4.1884, 3.5919];


%% Recovery technique = 4
% with tone fact = 0.2 and HWHM = 0.5, zero outside 1GHz gap
BER4_L0 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2.3482e-05, 0.00083361];
Q4_L0 = [19.8291, 19.856, 19.8168, 19.7344, 19.6876, 19.6064, 19.363, ...
    18.6381, 17.8502, 16.4848, 14.0921, 11.8904];

BER16_L0 = [2.9352e-05, 5.2834e-05, 7.6316e-05, 4.1093e-05, 4.6964e-05, ...
    5.2834e-05, 8.8057e-05, 0.00032288,0.0010273, 0.0037278, 0.016132, 0.039855];
Q16_L0 = [19.0369, 19.034, 18.9988, 19.0068, 18.9427,18.7911, 18.6149, ...
    18.0584, 17.3215, 16.1394, 13.9125, 11.6003];

BER64_L0 = [0.017486, 0.018093, 0.017204, 0.017799, 0.018335, 0.019275, ...
    0.021149, 0.025505, 0.034722, 0.047852, 0.078386, 0.1125];
Q64_L0 = [18.7665, 18.7211,18.7746, 18.7293, 18.6767, 18.5767, 18.3649, ...
    17.9215, 17.1029, 15.9904, 13.7237, 11.4681];
GMIx64_L0 = [5.5229, 5.5271, 5.5286, 5.5234, 5.5055, 5.4833, 5.4338, 5.3462, ...
    5.1598, 4.8651, 4.2218, 3.5921];
GMIy64_L0 = [5.539, 5.5418, 5.5778, 5.5596, 5.5281, 5.5174, 5.4605, 5.3789, ...
    5.1776, 4.9162, 4.2519, 3.5579];


%% Recovery technique = 5
% tone_fact=0.2, DC_fact = 0.02, full lineshape
BER4_L = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7.0446e-05, 0.0013502];
Q4_L = [17.9147, 17.9105, 17.8786, 17.8542, 17.8398, 17.7934, 17.5963, ...
    17.2345, 16.6614, 15.7021, 13.7844, 11.7535];

BER16_L = [0.0010919, 0.0010508, 0.0010743, 0.0012093, 0.0011506, 0.0013854, ...
    0.00145, 0.0020781, 0.0034225, 0.0067804, 0.021363, 0.04107];
Q16_L = [17.212, 17.2118, 17.1798, 17.1914, 17.1352, 17.0969, 16.9733, ...
    16.6524, 16.1274, 15.282, 13.2737, 11.4414];

BER64_L = [0.03579, 0.035732, 0.036663, 0.036135, 0.036315, 0.037563, ...
    0.039, 0.042827, 0.049347, 0.05964, 0.086914, 0.11548];
Q64_L = [17.0364, 17.041, 16.9755, 17.0148, 16.9779, 16.9228, 16.7851, ...
    16.4575, 15.9483, 15.1004, 13.1938, 11.3391];
GMIx64_L = [5.1816, 5.2038, 5.1847, 5.1935, 5.1851, 5.1574, 5.1228, 5.0391, ...
    4.9113, 4.6378, 4.1168, 3.5709];
GMIy64_L = [5.1662, 5.1657, 5.1768, 5.175, 5.1763, 5.1603, 5.1203, 5.0176, ...
    4.8674, 4.6406, 4.1089, 3.5853];


%% Plotting
% In order to plot nicely, BER needs to be on loglog axes, and Q & GMI need
% to be on semilogx axes

% Some examples:
figure(7)
loglog(linewidth, BER4_PC, '-o', ...
            linewidth, BER4_L9, '-^', linewidth, BER4_L0, '-p')
title('16-QAM BER Comparison of Jignesh Filters')
xlabel('Linewidth (Hz)')
ylabel('Bit Error Rate')
ylim([1e-5 1])
legend('Without Deterministic Phase Recovery', ...  
         'Including Jignesh Filter','Including Modified Jignesh Filter')
legend('Location', 'northwest')

figure(8)
semilogx(linewidth, Q16_PC, '-o',linewidth, Q16_BWs, '-s', linewidth, Q16_BW, '-d')
title('16-QAM Q Comparison of Fragkos Filters')
xlabel('Linewidth (Hz)')
ylabel('Q (dB)')
ylim([0 22])
legend('Without Deterministic Phase Recovery','Including Fragkos Filter', ...
    'Including Modified Fragkos Filter')
legend('Location', 'southwest')

figure(9)
semilogx(linewidth, GMIx64_PC, '-s', linewidth, GMIx64_L9, '-x', linewidth, GMIx64_L0, '-d')
title('Comparison of GMI in 64-QAM System')
xlabel('Linewidth (Hz)')
ylabel('Bits/Symbol')
xlim([1e3 1e8])
ylim([0 6])
legend('Without Deterministic Phase Recovery', 'Including Jignesh Filter', ...
    'Including Modified Jignesh Filter')
legend('Location', 'southwest')


