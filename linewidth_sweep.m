close all; clear all; clc;

Laser = [1e3, 1e4, 1e5, 1e6, 1e7];
Laser2 = [1e3, 1e4, 1e5, 2e5, 5e5, 8e5, 1e6, 2e6, 5e6, 8e6, 1e7, 2e7, 5e7, 8e7, 1e8];
Laser3 = [1e3, 1e4, 1e5, 2e5, 5e5, 8e5, 1e6];
Laser4 = [1e3, 1e4, 1e5, 2e5, 5e5, 8e5, 1e6, 2e6, 5e6, 8e6, 1e7, 2e7];
% without added phase noise (COT) recovery

BERX125 = [5.1515e-05, 3.606e-05, 4.6363e-05, 0.49808, 0.49742, 0.00012363, 0.49866];
Q2X125 = [19.0719, 19.0623, 19.0187, -3.0034, -2.9501, 18.397, -2.9977];
BERX25 = [0.00084227, 0.0010052, 0.0010002, 0.0010177, 0.0012032, 0.0011631, 0.0013938, 0.0018425, 0.0043267, 0.49944, 0.49992, 0.49947];
Q2X25 = [16.6877, 16.6342, 16.6383, 16.6, 16.4814, 16.433, 16.3784, 16.1441, 15.401, -3.0094, -3.0033, -3.0072];
BERX50 = [0.011696, 0.011696, 0.01197, 0.011799, 0.012161, 0.012224, 0.01236, 0.012722, 0.014988, 0.017008, 0.49918, 0.49939, 0.49884, 0.4984, 0.069696];
Q2X50 = [13.8002, 13.8344, 13.7788, 13.8138, 13.7712, 13.8054, 13.7521, 13.6816, 13.4502, 13.2677, -3.0215, -3.0017, -2.9914, -2.9901, 9.5792];
BERX100 = [0.047437, 0.047141, 0.047355, 0.047168, 0.047026, 0.047079, 0.047421, 0.048262, 0.048261, 0.049072, 0.05041, 0.49957, 0.50008, 0.071409, 0.49931];
Q2X100 = [11.0022, 10.9964, 10.996, 10.9985, 10.9903, 10.9892, 10.9841, 10.9502, 10.9302, 10.8827, 10.8181, -2.9824, -2.9996, 9.6954, -3.005];

BERX1254 = [0, 0, 0, 0, 0, 0, 0, 0, 0.49791, 0.4978, 0.4965, 0.49822];
Q2X1254 = [19.5983, 19.5787, 19.4839, 19.3979, 19.0344, 18.7584, 18.5821, 17.8238, -2.9834, -2.9966, -2.9864, -2.9837];
BERX254 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6.645e-05, 0.49881, 0.4971, 0.5];
Q2X254 = [16.65, 16.6918, 16.6248, 16.6034, 16.5915, 16.4586, 16.4259, 16.2002, 15.4872, 14.9105, 14.4889, 12.8916, -3.0054, -2.9865, -3];
BERX504 = [0, 0, 0, 0, 0, 7.9534e-06, 0, 0, 0, 7.9534e-06, 0, 2.386e-05, 0.0016305, 0.0026405, 0.49852];
Q2X504 = [13.9465, 13.9482, 13.9282, 13.9143, 13.8986, 13.8658, 13.8347, 13.7796, 13.5918, 13.3815, 13.2585, 12.6424, 10.4387, 10.2742, -3.0054];
BERX1004 = [0.00031542, 0.00022196, 0.00028037, 0.00022196, 0.00029205, 0.00030373, 0.00025701, 0.00024922, 0.00027648, 0.00029205, 0.00036214, 0.00049454, 0.0013279, 0.0023559, 0.019443];
Q2X1004 = [11.05, 11.0667, 11.0492, 11.0854, 11.0444, 11.0566, 11.0537, 11.044, 10.9699, 10.9182, 10.8892, 10.6894, 10.0002, 9.6956, 7.2262];

loglog(Laser3, BERX125, Laser4, BERX25, Laser2, BERX50, Laser2, BERX100, Laser4, BERX1254, Laser2, BERX254, Laser2, BERX504, Laser2, BERX1004)
title('BER (x-pol)')
legend('12.5baud, 16-QAM', '25baud, 16-QAM', '50baud, 16-QAM', '100baud, 16-QAM', '12.5baud 4-QAM', '25baud, 4-QAM','50baud, 4-QAM','100baud, 4-QAM')
legend('Location', 'best')

figure
semilogx(Laser3, Q2X125, Laser4, Q2X25, Laser2, Q2X50, Laser2, Q2X100, Laser4, Q2X1254, Laser2, Q2X254, Laser2, Q2X504, Laser2, Q2X1004)
title('Q^2 (x-pol)')
legend('12.5baud, 16-QAM', '25baud, 16-QAM', '50baud, 16-QAM', '100baud, 16-QAM', '12.5baud 4-QAM', '25baud, 4-QAM', '50baud, 4-QAM','100baud, 4-QAM')