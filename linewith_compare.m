% linewidth comparing with & without my phase comp
close all; clear all; clc;

Laser = [1e3, 1e4, 1e5, 2e5, 5e5, 8e5, 1e6, 2e6, 5e6, 8e6, 1e7, 2e7, 5e7, 8e7, 1e8];

%% 4-QAM
BERwo = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.003851, 0.49748, 0.49563, 0.49565];
Qwo = [28.0845, 27.9975, 27.245, 26.6873, 24.9296, 23.679, 23.1953, 20.843, 17.3233, 15.4446, 14.4774, 10.5628, -2.9852, -2.987, -2.9672];

BERw = [0.20558, 0.20486, 0.20517, 0.20581, 0.20529, 0.20577, 0.20549, 0.20441, 0.20515, 0.20524, 0.20565, 0.20562, 0.20587, 0.20681, 0.20801];
Qw = [2.4175, 2.4243, 2.4195, 2.4188, 2.4213, 2.4128, 2.4151, 2.4125, 2.4044, 2.3986, 2.3912, 2.3503, 2.2566, 2.156, 2.0618];

BERboth = [0.00015263, 0.0014559, 0.0034988];
Qboth = [24.2639, 24.2148, 24.1867, 24.1379, 23.8623, 23.7044, 23.5841, 22.9936, 21.5793, 20.4413, 19.842, 17.6293, 14.4173, 12.4406, 11.4519];

% 4-QAM no OSNRImpair
BERwoO = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00012915, 0, 0.49704, 0.49834, 0.49547, 0.4954];
QwoO = [28.9015, 28.8004, 28.1598, 27.0298, 25.3691, 23.9292, 23.366, 21.1806, 17.0114, 15.5804, 14.8154, -2.9854, -2.9914, -2.9858, -2.9767];

BERbothO = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8.2187e-05, 0.0013267, 0.0032522];
QbothO = [25.2101, 25.2136, 25.1227, 25.0152, 24.7387, 24.4961, 24.3653, 23.4855, 22.0324, 20.7436, 20.0893, 17.8713, 14.5592, 12.3784, 11.418];

figure(1)
loglog(Laser, BERwo, Laser, BERw, Laser(end-2:end), BERboth, Laser, BERwoO, Laser, BERbothO)
title('BER - 4-QAM, 40dB OSNR')
legend('Only PhaseComp', 'Only my algorithm', 'Both', 'Only PhaseComp - wo OSNRImpair', 'Both - wo OSNRImpair')
legend('Location', 'best')

figure(2)
semilogx(Laser, Qwo, Laser, Qw, Laser, Qboth, Laser, QwoO, Laser, QbothO)
title('Q^2 - 4-QAM, 40dB OSNR')
legend('Only PhaseComp', 'Only my algorithm', 'Both', 'Only PhaseComp - wo OSNRImpair', 'Both - wo OSNRImpair')
legend('Location', 'best')

%% 16-QAM 
BERwo = [0, 0, 0, 0, 0, 0, 0, 0.00011741, 0.01278, 0.010643, 0.17362, 0.04839, 0.10688, 0.49736, 0.21444];
Qwo = [24.2579, 24.2341, 23.8724, 23.5835, 22.7381, 21.9311, 21.5254, 19.804, 14.7829, 15.2146, 5.9546, 11.1128, 7.4822, -2.9661, 3.0433];

BERw = [0.2539, 0.25369, 0.25423, 0.25372, 0.25387, 0.25341, 0.25345, 0.25332, 0.25368, 0.2539, 0.25413, 0.25449, 0.25483, 0.25776, 0.25736];
Qw = [2.3902, 2.3912, 2.3875, 2.3914, 2.3854, 2.3852, 2.388, 2.391, 2.3797, 2.3502, 2.3505, 2.329, 2.2404, 2.124, 2.0753];

BERboth = [0, 0, 0, 0, 1.7611e-05, 0, 5.8705e-06, 2.9352e-05, 8.2187e-05, 0.00037571, 0.00061053, 0.003446, 0.018398, 0.03443, 0.043706];
Qboth = [22.1024, 22.0659, 22.0258, 21.9706, 21.861, 21.6876, 21.5927, 21.2437, 20.1524, 19.2386, 18.8309, 17.0311, 13.9157, 12.1114, 11.2764];

% 16-QAM no OSNR Impair
BERwoO = [0, 0, 0, 0, 0, 0, 0, 9.3928e-05, 0.0038041, 0.013185, 0.49891, 0.48599, 0.4973, 0.18262, 0.27808];
QwoO = [24.5722, 24.539, 24.1627, 23.8219, 22.8107, 22.0716, 21.6216, 19.9644, 16.8457, 14.8499, -2.9593, -2.9148, -2.9655, 4.0952, 1.2582];

BERbothO = [0, 0, 0, 0, 0, 0, 0, 0, 4.1093e-05, 0.00024069, 0.00043442, 0.0030057, 0.018011, 0.032522, 0.043852];
QbothO = [22.8302, 22.8246, 22.7832, 22.7231, 22.5717, 22.4411, 22.3323, 21.8607, 20.7382, 19.8466, 19.2135, 17.2441, 13.9526, 12.2974, 11.2004];

figure(3)
loglog(Laser, BERwo, Laser, BERw, Laser, BERboth, Laser, BERwoO, Laser, BERbothO)
title('BER - 16-QAM, 40dB OSNR')
legend('Only PhaseComp', 'Only my algorithm', 'Both', 'Only PhaseComp - wo OSNRImpair', 'Both - wo OSNRImpair')
legend('Location', 'best')

figure(4)
semilogx(Laser, Qwo, Laser, Qw, Laser, Qboth, Laser, QwoO, Laser, QbothO)
title('Q^2 - 16-QAM, 40dB OSNR')
legend('Only PhaseComp', 'Only my algorithm', 'Both', 'Only PhaseComp - wo OSNRImpair', 'Both - wo OSNRImpair')
legend('Location', 'best')


%% 64-QAM 
BERwo = [0.00049312, 0.00048921, 0.00062227, 0.0010489, 0.0026143, 0.0040115, 0.0060348, 0.017498, 0.50015, 0.389, 0.49779, 0.49807, 0.49867, 0.49777, 0.49901];
Qwo = [23.1361, 23.1283, 22.9002, 22.544, 21.8144, 21.366, 20.8525, 19.037, -3.0024, 1.465, -2.9727, -2.9749, -2.9857, -3.0005, -2.9867];

BERw = [0.30844, 0.30819, 0.30854, 0.30809, 0.30784, 0.30868, 0.30819, 0.30819, 0.30822, 0.30809, 0.30833, 0.30991, 0.49815, 0.31415, 0.49695];
Qw = [2.3835, 2.3874, 2.3813, 2.3845, 2.3847, 2.3815, 2.3775, 2.3758, 2.3692, 2.3607, 2.3502, 2.3126, -2.9786, 2.1227, -2.9903];

BERboth = [0.0034714, 0.0033383, 0.0036162, 0.0037454, 0.0040389, 0.0046807, 0.004802, 0.0064223, 0.01171, 0.01695, 0.020641, 0.035689, 0.069988, 0.096225, 0.11071];
Qboth = [21.4713, 21.4841, 21.4391, 21.4067, 21.2906, 21.1429, 21.0989, 20.7229, 19.8184, 19.0245, 18.5451, 16.9087, 13.8657, 12.084, 11.1393];

% 64-QAM no OSNR Impair
BERwoO = [0.00024265, 0.00025439, 0.00040311, 0.0006301, 0.49994, 0.49758, 0.49799, 0.49237, 0.13578, 0.49701, 0.2627, 0.49846, 0.24879, 0.4967, 0.49821];
QwoO = [23.8103, 23.7768, 23.4523, 23.1751, -3.0029, -2.9941, -2.9758, -2.9845, 10.8424, -2.9496, 5.9256, -3.0102, 4.6818, -2.9673, -2.9994];

BERbothO = [0.0021838, 0.0021799, 0.002266, 0.0024578, 0.0026691, 0.0031583, 0.0032601, 0.0048099, 0.0094397, 0.015024, 0.017893, 0.034448, 0.069593, 0.093442, 0.10889];
QbothO = [22.2097, 22.2068, 22.167, 22.1146, 22.0155, 21.8172, 21.7851, 21.333, 20.3002, 19.4004, 18.9189, 16.9778, 13.9147, 12.1992, 11.2452];
    
figure(5)
loglog(Laser, BERwo, Laser, BERw, Laser, BERboth, Laser, BERwoO, Laser, BERbothO)
title('BER - 64-QAM, 40dB OSNR')
legend('Only PhaseComp', 'Only my algorithm', 'Both', 'Only PhaseComp - wo OSNRImpair', 'Both - wo OSNRImpair')
legend('Location', 'best')

figure(6)
semilogx(Laser, Qwo, Laser, Qw, Laser, Qboth, Laser, QwoO, Laser, QbothO)
title('Q^2 - 64-QAM, 40dB OSNR')
legend('Only PhaseComp', 'Only my algorithm', 'Both', 'Only PhaseComp - wo OSNRImpair', 'Both - wo OSNRImpair')
legend('Location', 'best')




