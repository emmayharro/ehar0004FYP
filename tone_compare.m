%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                         Final Year Project                              %
%                               2020                                      %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Written by: Emily Harrison (ID: 28761537)
% Supervised by: Dr Bill Corcoran

% PROJECT AIM: produce an optical communications system that uses Optical
% Injection Locking to improve the reliability of the system

% THE PROJECT focuses on M-QAM signals, where M is between 4 and 256. It
% uses linewidths ranging from 1kHz to 10MHz. Transmission speeds are
% between 100Gbps and 1Tbps over distances up to 5000km.

% THIS SCRIPT 

%% Housekeeping
close all; clear all; clc;

% All graphs cover the following laser linewidths
Laser = [1e3, 1e4, 1e5, 2e5, 5e5, 8e5, 1e6, 2e6, 5e6, 8e6, 1e7, 2e7, 5e7, 8e7, 1e8];

%% Tone fact 0.1
BER4_01 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00023482, 0.0010919, 0.0027474];
Q4_01 = [18.2169, 18.2198, 18.2214, 18.1997, 18.1499, 18.0879, 18.0607, 17.8861, 17.4465, 17.0827, 16.7364, 15.731, 13.5557, 12.0122, 11.3254];

BER16_01 = [0.0022132, 0.0023364, 0.0022543, 0.0022895, 0.0024656, 0.002536, 0.0026006, 0.0027943, 0.0038099, 0.0047257, 0.0053715, 0.0094632, 0.023652, 0.039197, 0.046424];
Q16_01 = [17.5522, 17.5364, 17.5262, 17.5169, 17.4675, 17.4094, 17.3957, 17.2791, 16.8652, 16.4927, 16.3112, 15.3163, 13.347, 11.8104, 11.176];

BER64_01 = [0.030433, 0.030785, 0.030984, 0.031027, 0.031325, 0.032151, 0.032409, 0.033219, 0.037133, 0.041813, 0.043312, 0.053867, 0.0787, 0.1004, 0.11403];
Q64_01 = [17.4568, 17.4296, 17.4253, 17.4201, 17.3789, 17.319, 17.2951, 17.1697, 16.8352, 16.3542, 16.1909, 15.2777, 13.4443, 11.9085, 11.0766];

%% tone fact 1/sqrt(10)
BER4_1S10 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00012915, 0.00035223];
Q4_1S10 = [21.0771, 21.0686, 21.0514, 21.0396, 20.9065, 20.8321, 20.7865, 20.5054, 19.7353, 19.2149, 18.862, 17.2806, 14.6916, 13.1259, 12.4324];

BER16_1S10 = [2.3482e-05, 1.1741e-05, 1.7611e-05, 4.1093e-05, 4.1093e-05, 1.1741e-05, 3.5223e-05, 4.1093e-05, 0.00017611, 0.00042854, 0.00072207, 0.0026828, 0.013813, 0.025912, 0.032792];
Q16_1S10 = [20.1088, 20.1098, 20.0741, 20.0469, 20.0014, 19.9135, 19.8642, 19.6656, 19.0473, 18.5617, 18.2261, 16.8485, 14.3883, 12.9016, 12.2523];

BER64_1S10 = [0.011643, 0.0116, 0.011815, 0.01178, 0.012434, 0.012665, 0.013056, 0.014794, 0.019447, 0.023439, 0.025775, 0.037485, 0.066923, 0.091165, 0.10198];
Q64_1S10 = [19.6242, 19.6185, 19.5978, 19.5876, 19.5104, 19.4707, 19.4149, 19.205, 18.62, 18.1656, 17.8964, 16.7485, 14.3673, 12.77, 12.0187];

%% tone fact 0.5
BER4_05 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8.2187e-05, 0.00044616, 0.00095102];
Q4_05 = [18.5016, 18.4986, 18.4858, 18.4585, 18.4018, 18.3814, 18.3371, 18.1782, 17.7378, 17.2705, 17.0139, 16.0033, 13.8231, 12.3949, 11.8278];

BER16_05 = [5.8705e-05, 4.1093e-05, 4.1093e-05, 5.2834e-05, 4.6964e-05, 5.8705e-05, 8.2187e-05, 0.00018786, 0.00043442, 0.00075729, 0.001268, 0.0040682, 0.016972, 0.030761, 0.039655];
Q16_05 = [17.7987, 17.8138, 17.7886, 17.7801, 17.7358, 17.7066, 17.6579, 17.5117, 17.1259, 16.7825, 16.5779, 15.6105, 13.5255, 12.2421, 11.4938];

BER64_05 = [0.030319, 0.030002, 0.030229, 0.030589, 0.030957, 0.031771, 0.032061, 0.033434, 0.038953, 0.043661, 0.046823, 0.059366, 0.086711, 0.10692, 0.12011];
Q64_05 = [17.3875, 17.401, 17.4003, 17.3726, 17.3356, 17.2875, 17.2697, 17.1476, 16.7762, 16.4326, 16.1924, 15.3243, 13.3957, 12.1362, 11.4079];

%% tone fact sqrt(10)
BER4_S10 = [0.0047903, 0.0049195, 0.0052482, 0.0052012, 0.005166, 0.0051543, 0.0056357, 0.0065045, 0.0090405, 0.011201, 0.013537, 0.021216, 0.042537, 0.05908, 0.067417];
Q4_S10 = [4.8566, 4.8571, 4.8542, 4.8554, 4.8485, 4.8499, 4.8475, 4.8402, 4.8075, 4.7757, 4.7673, 4.6913, 4.4529, 4.26, 4.1426];

BER16_S10 = [0.23095, 0.23091, 0.23082, 0.23109, 0.23094, 0.23123, 0.23065, 0.23109, 0.23193, 0.23187, 0.23157, 0.23387, 0.23709, 0.24188, 0.24456];
Q16_S10 = [4.6543, 4.6514, 4.6522, 4.6493, 4.6531, 4.644, 4.6406, 4.6332, 4.6066, 4.5795, 4.5655, 4.4839, 4.2547, 4.0231, 3.8983];

BER64_S10 = [0.32626, 0.32667, 0.32668, 0.32648, 0.32656, 0.32679, 0.32665, 0.32657, 0.3266, 0.32728, 0.32684, 0.3272, 0.32797, 0.33185, 0.3328];
Q64_S10 = [4.7014, 4.7012, 4.7005, 4.7001, 4.6965, 4.6881, 4.6922, 4.6808, 4.6557, 4.6303, 4.6184, 4.5291, 4.2881, 4.079, 3.9498];


%% Graphs
semilogx(Laser, Q4_01, Laser, Q16_01, Laser, Q64_01, Laser, Q4_1S10, Laser, Q16_1S10, Laser, Q64_1S10, Laser, Q4_05, Laser, Q16_05, Laser, Q64_05, Laser, Q4_S10, Laser, Q16_S10, Laser, Q64_S10)
legend('4QAM 0.1', '16QAM 0.1', '64QAM 0.1', '4QAM 1/sqrt(10)', '16QAM 1/sqrt(10)', '64QAM 1/sqrt(10)', '4QAM 0.5', '16QAM 0.5', '64QAM 0.5', '4QAM sqrt(10)', '16QAM sqrt(10)', '64QAM sqrt(10)')

tone = [0.01, 0.1, 0.2, 1/sqrt(10), 0.4, 0.5, 0.7, 1, 2, sqrt(10)];
figure
hold on
plot(tone, [13.9936, Q4_01(1), 20.9876, Q4_1S10(1), 20.249, Q4_05(1), 14.8252, 11.3703, 6.5907, Q4_S10(1)])
plot(tone, [-2.7518, 27.7619, 27.4489, 23.7394, 21.5469, 18.7816, 14.9153, 11.3617, 6.5544, 4.8611])
plot(tone, [-2.9795, 13.3019, 18.6219, 20.4366, 19.7516, 18.3386, 14.8703, 11.4357, 6.6517, 4.8514])
plot(tone, [18.6688, 22.1802, 23.9689, 22.7345, 20.9595, 18.748, 15.0495, 11.3677, 6.6001, 4.8516])
xlabel('tone factor')
ylabel('Q^2')
title('4-QAM, 1e3 Linewidth')
legend('Lorentzian & Impaired', 'Only Phasecomp & 0 Impair', 'Lorentzian & 0 Impair', 'Lorentzian & Impaired - 2GHZ Gap')



